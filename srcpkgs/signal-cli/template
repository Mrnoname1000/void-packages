# Template file for 'signal-cli'
pkgname=signal-cli
version=0.6.2
revision=1
#build_wrksrc="signal-cli-$version"
hostmakedepends="gradle asciidoc"
depends="openjdk-jre libmatthew-java dbus"
short_desc="Commandline interface for Signal Private Messenger"
maintainer="Oliver Nutter <mrnoname1000@riseup.net>"
license="GPL-3.0"
homepage="https://github.com/AsamK/signal-cli"
distfiles="https://github.com/AsamK/signal-cli/archive/v${version}.tar.gz"
checksum=4b80322ab774611687f04296f79bde8c0188841983b619940af1d76dfd01b22b

do_build() {
	gradle build
	gradle installDist
	make -C man
}

do_install() {
	vbin "build/install/signal-cli/bin/signal-cli"

	vinstall "build/install/signal-cli/lib/argparse4j-0.8.1.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/bcprov-jdk15on-1.60.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/commons-codec-1.9.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/commons-logging-1.2.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/core-1.51.0.0.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/curve25519-java-0.4.1.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/dbus-java-2.7.0.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/debug-1.1.1.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/hexdump-0.2.1.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/httpclient-4.4.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/httpcore-4.4.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/jackson-annotations-2.9.0.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/jackson-core-2.9.5.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/jackson-databind-2.9.5.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/libphonenumber-8.8.10.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/okhttp-3.9.0.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/okio-1.13.0.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/pkix-1.51.0.0.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/protobuf-java-2.5.0.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/prov-1.51.0.0.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/signal-cli-0.6.2.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/signal-metadata-java-0.0.2.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/signal-protocol-java-2.7.0.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/signal-service-java-2.12.4_unofficial_1.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/threetenbp-1.3.6.jar" 0644 usr/lib
	vinstall "build/install/signal-cli/lib/unix-0.5.1.jar" 0644 usr/lib

	vman "man/signal-cli.1"
	vlicense LICENSE
}
